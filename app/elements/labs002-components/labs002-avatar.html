<!-- Copyright (c) 2015 The Locals Project Authors. All rights reserved.
See authors.md for a list of all members.
 -->
<!-- 
 {
  "component": "labs002-avatar",
  "conditions": [
    {
      "objectname": ""
    }
  ],
  "config": {
    "beard": [
      0,
      "red"
    ],
    "lijf": [
      0,
      "var(--primary-lightblue)"
    ],
    "bottom": [
      2,
      "red"
    ],
    "face": [
      0,
      "red"
    ],
    "glasses": [
      0,
      "red"
    ],
    "head": [
      0,
      "red"
    ],
    "shoes": [
      2,
      "black"
    ],
    "snit": [
      3,
      "red"
    ],
    "top": [
      0,
      "black"
    ]
  },
  "data": {
    "birthdate": "01/01/1970",
    "birthplace": "Geboorteplaats",
    "firstname": "Voornaam",
    "lastname": "Achternaam"
  },
  "description": "Lorem ipsum",
  "enabled": true,
  "hash": "hahaha",
  "height": 100,
  "locked": false,
  "name": "Avatar",
  "version": "0.0.1",
  "width": 100
} -->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-input/paper-input-container.html">

<link rel="import" href="../../bower_components/neon-animation/neon-animations.html">
<link rel="import" href="../../bower_components/iron-selector/iron-selector.html">


<link rel="import" href="labs002-avatar-snitpages.html">
<link rel="import" href="labs002-avatar-glassespages.html">
<link rel="import" href="labs002-avatar-beardpages.html">
<link rel="import" href="labs002-avatar-facepages.html">

<link rel="import" href="labs002-avatar-headpages.html">
<link rel="import" href="labs002-avatar-toppages.html">
<link rel="import" href="labs002-avatar-bottompages.html">
<link rel="import" href="labs002-avatar-shoespages.html">
<link rel="import" href="labs002-avatar-bodypages.html">

<link rel="import" href="labs002-skeletonpages.html">
<link rel="import" href="labs002-skeletonheadbandpages.html">


<link rel="import" href="labs002-colorpicker.html">

<link rel="import" href="../lo-configbtns/lo-configbtns.html">

<dom-module id="labs002-avatar">


  <style>
   :host {
      display: block;
      height: 100%;
      width: 100%;

      background: linear-gradient(to bottom, #a4e5f9 65%, white 35% ); 



    }

    neon-animated-pages {
      height: 100%;
    }

    .canvas {
/*      border: 1px solid green;*/
      height: 100%;
      width: 100%;

      @apply(--layout-horizontal);
      @apply(--layout-center-center);
    }

    .whitebg {
      background-color: white;
    }




    .pagecontainer {
      width: 100%;
      max-width: 400px;
      height: 100%;
      max-height: 400px;
      position: relative;


    }

    .absolutepos {
      position: absolute;
      width: 100%;
      height: 100%;

    }



  </style>
  <template>


<neon-animated-pages id="avatarmainpages" selected="{{selected}}" entry-animation="{{entryAnimation}}" exit-animation="{{exitAnimation}}">

  <neon-animatable>
  <div class="canvas">

    <template is="dom-if" if="{{edit}}">
      <div class="leftbtns">
        <lo-configbtns context="snit" on-btn-tapped="previous"></lo-configbtns>
        <lo-configbtns context="glasses" on-btn-tapped="previous"></lo-configbtns>
        <lo-configbtns context="beard" on-btn-tapped="previous"></lo-configbtns>
        <lo-configbtns context="top" on-btn-tapped="previous"></lo-configbtns>
        <lo-configbtns context="bottom" on-btn-tapped="previous"></lo-configbtns>
        <lo-configbtns context="shoes" on-btn-tapped="previous"></lo-configbtns>
      </div>                
    </template>

    <div class="pagecontainer">

      <div class="absolutepos">
        <labs002-avatar-bodypages 
          id="lijf">
        </labs002-avatar-bodypages>
      </div>

      <div class="absolutepos">
        <labs002-avatar-shoespages 
          id="shoes"
          nrofitems="{{nrofshoes}}">
        </labs002-avatar-shoespages>
      </div>

      <div class="absolutepos">
        <labs002-avatar-bottompages 
          id="bottom"
          nrofitems="{{nrofbottom}}">
        </labs002-avatar-bottompages>
      </div>

      <div class="absolutepos">
        <labs002-avatar-toppages 
          id="top"
          nrofitems="{{nroftop}}">
        </labs002-avatar-toppages>
      </div>

      <div class="absolutepos">
        <labs002-avatar-headpages 
          id="head"
          nrofitems="{{nrofhead}}">
        </labs002-avatar-headpages>
      </div>

      <div class="absolutepos">
        <labs002-avatar-facepages 
          id="face">
        </labs002-avatar-facepages>
      </div>

      <div class="absolutepos">
        <labs002-avatar-glassespages 
          id="glasses"
          nrofitems="{{nrofglasses}}">
        </labs002-avatar-glassespages>
      </div>

      <div class="absolutepos">
        <labs002-avatar-beardpages 
          id="beard"
          nrofitems="{{nrofbeard}}">
        </labs002-avatar-beardpages>
      </div>

      <div class="absolutepos">
        <labs002-avatar-snitpages
        id="snit"
        nrofitems="{{nrofglasses}}">
        </labs002-avatar-snitpages>
      </div>



    </div>

    <template is="dom-if" if="{{edit}}">
      <div class="righttbtns">

        <lo-configbtns context="snit" on-btn-tapped="next" next></lo-configbtns>
        <lo-configbtns context="glasses" on-btn-tapped="next" next></lo-configbtns>
        <lo-configbtns context="beard" on-btn-tapped="next" next></lo-configbtns>
        <lo-configbtns context="top" on-btn-tapped="next" next></lo-configbtns>
        <lo-configbtns context="bottom" on-btn-tapped="next" next></lo-configbtns>
        <lo-configbtns context="shoes" on-btn-tapped="next" next></lo-configbtns>

      </div>                
    </template>

  </div>
  </neon-animatable>


  <neon-animatable>
    <div class="canvas whitebg">

      <paper-input-container>
        <label>De eerste value?</label>
        <input autofocus type="text" is="iron-input" bind-value="{{objectdata.firstval}}">
      </paper-input-container>

    </div>
  </neon-animatable>

  </neon-animated-pages>

  </template>
  <script>
  (function() {
    Polymer({
      is: 'labs002-avatar',

      behaviors: [
      Polymer.NeonAnimatableBehavior
      ],

      properties: {
      // objectconfig: {
      //     type: Object,
      //     observer: "_configChanged",
      //     notify: true
      // },

      // objectdata: {
      //     type: Object,
      //     observer: "_dataChanged",
      //     notify: true
      // },


      // edit: {
      //   type: Boolean,
      //   value: false
      // },


      // itemtocolor: {
      //   type: String,
      //   value: ''
      // },

      // opened: {
      //   type: Boolean,
      //   value: false,
      //   observer: "editListener"
      // },

      // active: {
      //   type: Boolean,
      //   value: false
      // },

      // selecteditem: {
      //   type: String,
      //   observer: "_selecteditem",
      //   value: ""
      // },

      // selectedcolor: {
      //   type: String,
      //   observer: "_selectedcolor"
      // }


        objectconfig: {
          type: Object,
          notify: true,
          observer: "_configChanged"
        },

        objectdata: {
          type: Object,
          notify: true,
          observer: "_dataChanged"
        },

        edit: {
          type: Boolean,
          value: false,
          observer: "_editChanged"

        },

        opened: {
          type: Boolean,
          value: false
        },

        objecthash: {
          type: String
        }


      },


      ready: function(){
        this.$.avatarmainpages.selected = 0;
        this.itemtocolor = "lijf";
      },


      attached: function() {
        this.async(function() {
        this._configChanged();
        this._dataChanged();
      });

      this.entryAnimation = 'fade-in-animation';
      this.exitAnimation = 'fade-out-animation';
      },

      detached: function() {
        this.async(function() {
          //console.log(this.localName + '#' + this.id + ' was detached');
       });
      },




    previous: function(e){
        this.selecteditem = e.target.context;
        var item = document.getElementById(this.selecteditem);
        console.log("PREV: nr of items: ",item.nrofitems, " current item: ",this.objectconfig[this.selecteditem][0]);
         if(this.objectconfig[this.selecteditem][0]>=1){
          console.log(this.objectconfig[this.selecteditem][0]);
          this.objectconfig[this.selecteditem][0]--;
          e.target.active = true;
        } else {
          e.target.active = false;
        };
        this._configChanged();
        item.entryAnimation = "slide-to-left-animation";
        item.exitAnimation = "slide-right-animation";
      },

      next: function(e){
        this.selecteditem = e.target.context;
        var item = document.getElementById(this.selecteditem);
        console.log("NEXT: nr of items: ",item.nrofitems, " current item: ",this.objectconfig[this.selecteditem][0]);
        if(this.objectconfig[this.selecteditem][0]<=item.nrofitems-1){
          console.log(this.objectconfig[this.selecteditem][0]);
          this.objectconfig[this.selecteditem][0]++;
          e.target.active = true;
        } else {
          e.target.active = false;
        };
        this._configChanged();
        item.entryAnimation = "slide-to-right-animation";
        item.exitAnimation = "slide-left-animation";
      },



      _configChanged: function(){
        console.log('avatar conf changed: ', JSON.stringify(this.objectconfig));

        this.$.snit.selected = this.objectconfig.snit[0];
        this.$.snit.color = this.objectconfig.snit[1];

        this.$.glasses.selected = this.objectconfig.glasses[0];
        this.$.glasses.color = this.objectconfig.glasses[1];

        this.$.beard.selected = this.objectconfig.beard[0];
        this.$.beard.color = this.objectconfig.beard[1];

        this.$.face.selected = this.objectconfig.face[0];
        this.$.face.color = this.objectconfig.face[1];

         this.$.head.selected = this.objectconfig.head[0];
        this.$.head.color = this.objectconfig.lijf[1];

        this.$.top.selected = this.objectconfig.top[0];
        this.$.top.color = this.objectconfig.top[1];

        this.$.bottom.selected = this.objectconfig.bottom[0];
        this.$.bottom.color = this.objectconfig.bottom[1];

        this.$.shoes.selected = this.objectconfig.shoes[0];
        this.$.shoes.color = this.objectconfig.shoes[1];

        this.$.lijf.selected = this.objectconfig.lijf[0];
        this.$.lijf.color = this.objectconfig.lijf[1];

        // this.$.head.color = this.objectconfig.lijf[1];

      },

      _dataChanged: function(){

        this.firstname = this.objectdata.firstname;
        this.lastname = this.objectdata.lastname;
        this.birthdate = this.objectdata.birthdate;
        this.birthplace = this.objectdata.birthplace;
        //this.locked = this..locked;
      },

      unlock: function(){
        this.locked = false;
      },

      _editChanged: function(){
        console.log('Jamaar wa IS die edit nu eigenlijk?', this.edit);
      },


      _selectedcolor: function(){
        if(this.objectconfig){
          var item = this.selecteditem;
          var color = this.selectedcolor;
          this.objectconfig[item][1] = color;
          var avataritem = document.getElementById(item);
          avataritem.color = color;
          this._configChanged();
        };
      },


      editListener: function(){
          if(this.opened){
          this.selected = 1;
          } else {
            this.selected = 0;
          }; 
      },







    });
  })();
  </script>
</dom-module>










