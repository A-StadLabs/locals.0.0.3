<!-- Copyright (c) 2015 The Locals Project Authors. All rights reserved.
See authors.md for a list of all members.
 -->
<!-- 
 {
  "component": "labs002-avatar",
  "conditions": [
    {
      "objectname": ""
    }
  ],
  "config": {
    "beard": [
      0,
      "red"
    ],
    "lijf": [
      0,
      "var(--primary-lightblue)"
    ],
    "bottom": [
      2,
      "red"
    ],
    "face": [
      0,
      "red"
    ],
    "glasses": [
      0,
      "red"
    ],
    "head": [
      0,
      "red"
    ],
    "shoes": [
      2,
      "black"
    ],
    "snit": [
      3,
      "red"
    ],
    "top": [
      0,
      "black"
    ]
  },
  "data": {
    "birthdate": "01/01/1970",
    "birthplace": "Geboorteplaats",
    "firstname": "Voornaam",
    "lastname": "Achternaam"
  },
  "description": "Lorem ipsum",
  "enabled": true,
  "hash": "hahaha",
  "height": 100,
  "locked": false,
  "name": "Avatar",
  "version": "0.0.1",
  "width": 100
} -->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-input/paper-input-container.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animations.html">
<link rel="import" href="../../bower_components/iron-selector/iron-selector.html">
<link rel="import" href="labs002-avatar-snitpages.html">
<link rel="import" href="labs002-avatar-glassespages.html">
<link rel="import" href="labs002-avatar-beardpages.html">
<link rel="import" href="labs002-avatar-facepages.html">
<link rel="import" href="labs002-avatar-headpages.html">
<link rel="import" href="labs002-avatar-toppages.html">
<link rel="import" href="labs002-avatar-bottompages.html">
<link rel="import" href="labs002-avatar-shoespages.html">
<link rel="import" href="labs002-avatar-bodypages.html">
<link rel="import" href="labs002-skeletonpages.html">
<link rel="import" href="labs002-skeletonheadbandpages.html">
<link rel="import" href="../lo-peers/lo-peers.html">
<link rel="import" href="lo-colorpicker.html">
<link rel="import" href="../lo-configbtns/lo-configbtns.html">
<dom-module id="labs002-avatar">
  <style>
   :host {
      display: block;
      height: 100%;
      width: 100%;
    }

    neon-animated-pages {
      height: 100%;
    }

    .canvas {
      height: 100%;
      width: 100%;
    }

    .whitebg {
      background-color: white;
    }

    .thumbcontainer {
      width: 100%;
      max-width: 400px;
      height: 100%;
      position: relative;
      background: linear-gradient(to bottom, #a4e5f9 50%, white 50% ); 
    }

    .absolutepos {
      position: absolute;
      width: 100%;
      height: 100%;
    }

    .objectvaluesbar {
      width: 100%;
      margin: 0px;
      padding: 15px 15px 15px 20px;
      box-sizing:border-box;
      background-color: red;
      height: 60px;
      @apply(--layout-horizontal);
      @apply(--layout-center-center);
      box-sizing:border-box;
      border-radius: 0px 0px 2px 2px;
    }

    .valids {
      @apply(--layout-horizontal);
      @apply(--layout-end-justified);
      @apply(--layout-center);
      width: 20%;
      min-width: 40px;
      height: 100%;
    }

    .valids img {
      height: 15px;
      width: 15px;
    }

    .valids p {
      padding: 0px;
      margin: 0px 5px 0px 0px;
      font-size: var(--p-valids);
      font-family: OpensansBold;
      color: #333333;
    }

    .objectfirstvalue {
      @apply(--layout-horizontal);
      @apply(--layout-center);
      width: 80%;
      overflow: hidden;
      white-space: nowrap;
      text-overflow:ellipsis;
    }

    .objectfirstvalue p {
      width: 100%;
      text-align: left;
      margin: 0px;
      padding: 0px;
      font-family: Opensans;
      font-size: var(--p-size);
      color: #666666;
      overflow: hidden;
      white-space: nowrap;
      text-overflow:ellipsis;
    }

    .whitecanvas {
      background-color: white;
      width: 100%;
      height: 100%;
    }

    .avatarcanvas {
      background: linear-gradient(to bottom, #a4e5f9 50%, white 50% ); 
      width: 100%;
      height: 100vw;
      max-height: 400px;
      @apply(--layout-vertical);
      @apply(--layout-center);
    }

    lo-peers {
      width: 75px;
      height: 75px;
      background-color: transparent;
      margin: 30px 0px 30px 0px;
    }

    .valuesbox {
      background-color: #F4F4F4;
      width: 100%;
      margin: 0px;
      @apply(--layout-vertical);
      @apply(--layout-start); 
    }

    .values {
      width: 100%;
      height: 100%;
      padding: 20px 25px 25px 25px;
      box-sizing:border-box;
      text-align: center;
    }

    .values p {
      text-align: center;
      margin: 0px;
      padding: 0px;
      font-family: Opensans;
      font-size: 16px;
      color: #666666;
    }

    .lockedbtn {
      background-color: rgba(0,0,0,0.025);
      height: 75px;
      width: 75px;
      border-radius: 50%;
      border: none;
      outline: 0; 
      margin: 15px 0px 10px 0px;
    }

    .lockedbtn img {
      height: 100%;
      width: 100%;
    }




  /*  .avataredit {
      width: 100%;
      background-color: green;
    }

    iron-collapse {
      width: 100%;
      @apply(--layout-vertical);
      @apply(--layout-center); 
    }



    iron-selector {
      @apply(--layout-horizontal);

    }


    .test {
      width: 240px;
      border: 1px solid blue;
      height: 120px;
      @apply(--layout-horizontal);
      @apply(--layout-center);
    }


    .item {
      width: 60px;
      height: 60px;
      margin: 0px;
      padding: 0px;
      @apply(--layout-horizontal);
      @apply(--layout-center-center); 
    }

    .item p {
      margin: 0px;
      padding: 0px;
    }

    .iron-selected {
      background: #eee;
    }*/



    .avataredit {
      width: 100%;
      background-color: green;
    }


    iron-collapse {
      width: 100%;
      @apply(--layout-vertical);
      @apply(--layout-center); 

    }



    iron-selector {
      width: 240px;
      border: 1px solid blue;
      height: 120px;
      @apply(--layout-horizontal);
      @apply(--layout-wrap);
    }


/*    .test {
      width: 240px;
      border: 1px solid blue;
      height: 120px;
      @apply(--layout-horizontal);
      @apply(--layout-wrap);
    }*/


    .item {
      width: 60px;
      height: 60px;
      margin: 0px;
      padding: 0px;

      @apply(--layout-horizontal);
      @apply(--layout-center-center); 
      background-color: rgba(255,255,255,0.5);
    }

    .item p {
      margin: 0px;
      padding: 0px;

    }

    .iron-selected {
      background: #eee;
    }


labs002-colorpicker {
  width: 100%;
  background-color: red;
}



  </style>
<template>
<neon-animated-pages id="avatarmainpages" selected="{{selected}}" entry-animation="{{entryAnimation}}" exit-animation="{{exitAnimation}}">
<!--   0 //   THUMB PERVIEW -->
  <neon-animatable>
    <div class="canvas layout vertical center-center">
      <div class="thumbcontainer">
        <div class="absolutepos">
          <labs002-avatar-bodypages 
            selected="{{bodyselected}}"
            color="{{bodycolor}}"
            nrofitems="{{nrofbody}}">
          </labs002-avatar-bodypages>
        </div>
        <div class="absolutepos">
          <labs002-avatar-shoespages 
            selected="{{shoesselected}}"
            color="{{shoescolor}}"
            nrofitems="{{nrofshoes}}">
          </labs002-avatar-shoespages>
        </div>
        <div class="absolutepos">
          <labs002-avatar-bottompages 
            selected="{{bottomselected}}"
            color="{{bottomcolor}}"
            nrofitems="{{nrofbottom}}">
          </labs002-avatar-bottompages>
        </div>
        <div class="absolutepos">
          <labs002-avatar-toppages 
            selected="{{topselected}}"
            color="{{topcolor}}"
            nrofitems="{{nroftop}}">
          </labs002-avatar-toppages>
        </div>
        <div class="absolutepos">
          <labs002-avatar-headpages 
            selected="{{headselected}}"
            color="{{bodycolor}}"
            nrofitems="{{nrofhead}}">
          </labs002-avatar-headpages>
        </div>
        <div class="absolutepos">
          <labs002-avatar-facepages 
            selected="{{faceselected}}"
            color="{{facecolor}}">
          </labs002-avatar-facepages>
        </div>
        <div class="absolutepos">
          <labs002-avatar-glassespages 
            selected="{{glassesselected}}"
            color="{{glassescolor}}"
            nrofitems="{{nrofglasses}}">
          </labs002-avatar-glassespages>
        </div>
        <div class="absolutepos">
          <labs002-avatar-beardpages 
            selected="{{beardselected}}"
            color="{{beardcolor}}"
            nrofitems="{{nrofbeard}}">
          </labs002-avatar-beardpages>
        </div>
        <div class="absolutepos">
          <labs002-avatar-snitpages
            selected="{{snitselected}}"
            color="{{snitcolor}}"
          nrofitems="{{nrofglasses}}">
          </labs002-avatar-snitpages>
        </div>
      </div>
      <div class="objectvaluesbar">
        <div class="objectfirstvalue">
          <small>{{firstvalue}}</small>
        </div>
        <div class="valids">
          <p>{{objectpeers.length}}</p>
          <img src="../../images/accept-small.svg">
        </div>
      </div>
    </div>
  </neon-animatable>

  <!--   1 //   VALUES READ -->
  <neon-animatable>
    <div class="canvas layout vertical center">
      <div class="avatarcanvas" on-tap="toggleAvataredit">
        <div class="thumbcontainer">
          <div class="absolutepos">
            <labs002-avatar-bodypages 
              selected="{{bodyselected}}"
              color="{{bodycolor}}">
            </labs002-avatar-bodypages>
          </div>
          <div class="absolutepos">
            <labs002-avatar-shoespages 
              selected="{{shoesselected}}"
              color="{{shoescolor}}"
              nrofitems="{{nrofshoes}}">
            </labs002-avatar-shoespages>
          </div>
          <div class="absolutepos">
            <labs002-avatar-bottompages 
              selected="{{bottomselected}}"
              color="{{bottomcolor}}"
              nrofitems="{{nrofbottom}}">
            </labs002-avatar-bottompages>
          </div>
          <div class="absolutepos">
            <labs002-avatar-toppages 
              selected="{{topselected}}"
              color="{{topcolor}}"
              nrofitems="{{nroftop}}">
            </labs002-avatar-toppages>
          </div>
          <div class="absolutepos">
            <labs002-avatar-headpages 
              selected="{{headselected}}"
              color="{{bodycolor}}"
              nrofitems="{{nrofhead}}">
            </labs002-avatar-headpages>
          </div>
          <div class="absolutepos">
            <labs002-avatar-facepages 
              selected="{{faceselected}}"
              color="{{facecolor}}">
            </labs002-avatar-facepages>
          </div>
          <div class="absolutepos">
            <labs002-avatar-glassespages 
              selected="{{glassesselected}}"
              color="{{glassescolor}}"
              nrofitems="{{nrofglasses}}">
            </labs002-avatar-glassespages>
          </div>
          <div class="absolutepos">
            <labs002-avatar-beardpages 
              selected="{{beardselected}}"
              color="{{beardcolor}}"
              nrofitems="{{nrofbeard}}">
            </labs002-avatar-beardpages>
          </div>
          <div class="absolutepos">
            <labs002-avatar-snitpages
              selected="{{snitselected}}"
              color="{{snitcolor}}"
            nrofitems="{{nrofsnit}}">
            </labs002-avatar-snitpages>
          </div>
        </div>
      </div>
      <div class="avataredit">
        <iron-collapse id="avataredit">
          <lo-colorpicker
            on-color-changed="_selectedcolor">
          </lo-colorpicker>
          <lo-configbtns next on-tap="next" id="next"></lo-configbtns>
          <lo-configbtns on-tap="previous" id="previous"></lo-configbtns>
          <div class="test">
            <iron-selector id="itemselector" attr-for-selected="context" selected="body" on-iron-select="passItem">
              <div class="item" context="body">
                <p>body 8888</p>
                <img src="">
              </div>
              <div class="item" context="beard">
                <p>beard</p>
                <img src="">
              </div>         
              <div class="item" context="glasses">
                <p>glasses</p>
                <img src="">
              </div>
              <div class="item" context="snit">
                <p>snit</p>
                <img src="">
              </div>            
              <div class="item" context="top">
                <p>top</p>
                <img src="">
              </div>
              <div class="item" context="bottom">
                <p>bottom</p>
                <img src="">
              </div>      
              <div class="item" context="shoes">
                <p>shoes</p>
                <img src="">
              </div>
            </iron-selector>
          </div>
        </iron-collapse>
      </div>
      <div class="valuesbox" on-tap="toggleValuesedit">
        <div class="values">
          <p><span>{{firstvalue}}</span></p>    
          <iron-collapse id="valuesedit">
            <template is="dom-repeat" items="{{previewdata}}">
              <p><span>{{item}}</span><span>{{item.value}}</span></p>
            </template>
            <button class="lockedbtn" on-tap="toEdit">
              <img src="../../images/locked.svg">
            </button>
          </iron-collapse>
        </div>
      </div>
      <lo-peers peers="{{objectpeers}}" on-go-back="_toBack" valcolor="var(--primary-green)"></lo-peers>
    </div>
  </neon-animatable>



  <!--   2 //   VALUES EDIT -->
  <neon-animatable>
    <div class="canvas layout vertical center">
      <div class="avatarcanvas">
        <div class="thumbcontainer">
          <div class="absolutepos">
            <labs002-avatar-bodypages 
              selected="{{bodyselected}}"
              color="{{bodycolor}}">
            </labs002-avatar-bodypages>
          </div>
          <div class="absolutepos">
            <labs002-avatar-shoespages 
              selected="{{shoesselected}}"
              color="{{shoescolor}}"
              nrofitems="{{nrofshoes}}">
            </labs002-avatar-shoespages>
          </div>
          <div class="absolutepos">
            <labs002-avatar-bottompages 
              selected="{{bottomselected}}"
              color="{{bottomcolor}}"
              nrofitems="{{nrofbottom}}">
            </labs002-avatar-bottompages>
          </div>
          <div class="absolutepos">
            <labs002-avatar-toppages 
              selected="{{topselected}}"
              color="{{topcolor}}"
              nrofitems="{{nroftop}}">
            </labs002-avatar-toppages>
          </div>
          <div class="absolutepos">
            <labs002-avatar-headpages 
              selected="{{headselected}}"
              color="{{bodycolor}}"
              nrofitems="{{nrofhead}}">
            </labs002-avatar-headpages>
          </div>
          <div class="absolutepos">
            <labs002-avatar-facepages 
              selected="{{faceselected}}"
              color="{{facecolor}}">
            </labs002-avatar-facepages>
          </div>
          <div class="absolutepos">
            <labs002-avatar-glassespages 
              selected="{{glassesselected}}"
              color="{{glassescolor}}"
              nrofitems="{{nrofglasses}}">
            </labs002-avatar-glassespages>
          </div>
          <div class="absolutepos">
            <labs002-avatar-beardpages 
              selected="{{beardselected}}"
              color="{{beardcolor}}"
              nrofitems="{{nrofbeard}}">
            </labs002-avatar-beardpages>
          </div>
          <div class="absolutepos">
            <labs002-avatar-snitpages
              selected="{{snitselected}}"
              color="{{snitcolor}}"
            nrofitems="{{nrofglasses}}">
            </labs002-avatar-snitpages>
          </div>
        </div>
      </div>
      <div class="valuesbox">
        <div class="values">
          <paper-input-container>
            <label>Voornaam</label>
            <input autofocus type="text" is="iron-input" bind-value="{{objectdata.firstname}}">
          </paper-input-container>
          <paper-input-container>
            <label>Naam</label>
            <input type="text" is="iron-input" bind-value="{{objectdata.lastname}}">
          </paper-input-container>
          <paper-input-container>
            <label>Geboortedatum</label>
            <input type="text" is="iron-input" bind-value="{{objectdata.birthdate}}" >
          </paper-input-container>
          <paper-input-container>
            <label>Geboorteplaats</label>
            <input type="text" is="iron-input" bind-value="{{objectdata.birthplace}}" >
          </paper-input-container>
          <button on-tap="save">SAVE VALUES</button>
        </div>
      </div>
    </div>
  </neon-animatable>

</neon-animated-pages>
</template>
<script>
  (function() {
    Polymer({
      is: 'labs002-avatar',

      behaviors: [
      Polymer.NeonAnimatableBehavior
      ],

      properties: {
        objectconfig: {
          type: Object,
          notify: true,
          observer: "_configChanged"
        },

        objectdata: {
          type: Object,
          notify: true,
          observer: "_dataChanged"
        },

        edit: {
          type: Boolean,
          value: false,
          observer: "_editChanged"
        },

        opened: {
          type: Boolean,
          value: false
        },

        objecthash: {
          type: String
        },

        modus: {     
          type: Number,
          value: 0,
          notify: true,
          observer: "_modusChanged"        
        }
      },

        // MODI //
        // 0: THUMB PERVIEW
        // 1: VALUES READ
        // 2: VALUES WRITE
        // 3: AVATAR CONFIG  

      ready: function(){
        this.$.avatarmainpages.selected = this.modus;
        this.itemtocolor = 'lijf';
        this.nrof = [];
      },

      attached: function() {
        this.async(function() {
          this._configChanged();
          this._dataChanged();
        });
        this.entryAnimation = 'fade-in-animation';
        this.exitAnimation = 'fade-out-animation';
      },

      detached: function() {
        this.async(function() {
        });
      },

      passItem:function(){
        // hier dus een nieuwe functie die gaat checken of de prev/next buttons actief zijn of niet.
        var selecteditem = this.$.itemselector.selected;
        this.setButtonstates(selecteditem);
      },

      setButtonstates: function(selecteditem){
        if(selecteditem){
          var max = this.nrof[selecteditem];
          var cur = this.objectconfig[selecteditem][0];

          if(cur>=0&&cur<=max){
            this.$.next.active = true;
            this.$.previous.active = true;
          };

          if(cur==max){
            this.$.next.active = false;
            this.$.previous.active = true;
          };

          if(cur<=0){
            this.$.previous.active = false;
          };

        }; 
      },

      previous: function(e){
        var selecteditem = this.$.itemselector.selected;
        //var item = document.getElementById(this.selecteditem);
        if(this.objectconfig[selecteditem][0]>=0&&this.$.previous.active){
          this.objectconfig[selecteditem][0]--;
          this.setButtonstates(selecteditem);
        } else {
          this.setButtonstates(selecteditem);
        };
        this._configChanged();
          //item.entryAnimation = "slide-to-left-animation";
          //item.exitAnimation = "slide-right-animation";
        },

        next: function(e){
          var selecteditem = this.$.itemselector.selected;
          if(this.objectconfig[selecteditem][0]<=this.nrof[selecteditem]&&this.$.next.active){
            this.objectconfig[selecteditem][0]++;
            this.setButtonstates(selecteditem);
          } else {
            this.setButtonstates(selecteditem);
          };
          this._configChanged();
          //item.entryAnimation = "slide-to-right-animation";
          //item.exitAnimation = "slide-left-animation";
        },



      _configChanged: function(){

        this.setButtonstates(this.selecteditem);

        this.nrof = [];

        this.nrof['body'] = this.nrofbody; 
        this.nrof['top'] = this.nroftop;  
        this.nrof['snit'] = this.nrofsnit;
        this.nrof['beard'] = this.nrofbeard;
        this.nrof['glasses'] = this.nrofglasses;
        this.nrof['bottom'] = this.nrofbottom;
        this.nrof['shoes'] = this.nrofshoes;

        this.snitselected = this.objectconfig.snit[0];
        this.snitcolor = this.objectconfig.snit[1];

        this.glassesselected = this.objectconfig.glasses[0];
        this.glassescolor = this.objectconfig.glasses[1];

        this.beardselected = this.objectconfig.beard[0];
        this.beardcolor = this.objectconfig.beard[1];

        this.faceselected = this.objectconfig.face[0];
        this.facecolor = this.objectconfig.face[1];

         this.headselected = this.objectconfig.head[0];
        this.headcolor = this.objectconfig.lijf[1];

        this.topselected = this.objectconfig.top[0];
        this.topcolor = this.objectconfig.top[1];

        this.bottomselected = this.objectconfig.bottom[0];
        this.bottomcolor = this.objectconfig.bottom[1];

        this.shoesselected = this.objectconfig.shoes[0];
        this.shoescolor = this.objectconfig.shoes[1];

        this.lijfselected = this.objectconfig.lijf[0];
        this.lijfcolor = this.objectconfig.lijf[1];

        // this.$.head.color = this.objectconfig.lijf[1];

      },

      _dataChanged: function(){

        this.firstname = this.objectdata.firstname;
        this.lastname = this.objectdata.lastname;
        this.birthdate = this.objectdata.birthdate;
        this.birthplace = this.objectdata.birthplace;
        //this.locked = this..locked;
      },

      unlock: function(){
        this.locked = false;
      },

      _editChanged: function(){
      },


      editListener: function(){
          if(this.opened){
          this.selected = 1;
          } else {
            this.selected = 0;
          }; 
      },

      _modusChanged: function(){
        switch(this.modus){

          case 0:
            this.$.avatarmainpages.selected = this.modus;
          break;

          case 1:
            this.$.avatarmainpages.selected = this.modus;
          break;

          case 2:
            this.$.avatarmainpages.selected = this.modus;
          break;

          case 3:
            this.$.avatarmainpages.selected = this.modus;
          break;

        };
      },


      toEdit:function(){
        this.modus = 2;
      },


    toggleValuesedit:function(){
      this.$.valuesedit.toggle();
    },

    toggleAvataredit:function(){
      this.save();
      this.$.avataredit.toggle();
    },


      save:function(){
        this.fire('save-it', { datasetkey: this.objectname, dataset: this.objectdata, hash: this.objecthash, config: this.objectconfig });
        this.modus = 1;
      },

      _selectedcolor: function(e){
        var selectedcolor = e.detail.color;
        if(this.$.itemselector.selected&&selectedcolor){
          var item = this.$.itemselector.selected;
          var color = selectedcolor;
          this.objectconfig[item][1] = color;
          //var avataritem = document.getElementById(item);
          this._configChanged();
        };
        // if(this.objectconfig){
        //   var item = this.selecteditem;
        //   var color = this.selectedcolor;
        //   this.objectconfig[item][1] = color;
        //   var avataritem = document.getElementById(item);
        //   avataritem.color = color;
        //   this._configChanged();
        // };
      }

    });
  })();
  </script>
</dom-module>










