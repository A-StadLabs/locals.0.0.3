<!-- Copyright (c) 2015 The Locals Project Authors. All rights reserved.
See authors.md for a list of all members.
 -->
<!-- 
 {
  "component": "labs002-avatar",
  "conditions": [
    {
      "objectname": ""
    }
  ],
  "config": {
    "beard": [
      0,
      "red"
    ],
    "lijf": [
      0,
      "var(--primary-lightblue)"
    ],
    "bottom": [
      2,
      "red"
    ],
    "face": [
      0,
      "red"
    ],
    "glasses": [
      0,
      "red"
    ],
    "head": [
      0,
      "red"
    ],
    "shoes": [
      2,
      "black"
    ],
    "snit": [
      3,
      "red"
    ],
    "top": [
      0,
      "black"
    ]
  },
  "data": {
    "birthdate": "01/01/1970",
    "birthplace": "Geboorteplaats",
    "firstname": "Voornaam",
    "lastname": "Achternaam"
  },
  "description": "Lorem ipsum",
  "enabled": true,
  "hash": "hahaha",
  "height": 100,
  "locked": false,
  "name": "Avatar",
  "version": "0.0.1",
  "width": 100
} -->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-input/paper-input-container.html">

<link rel="import" href="../../bower_components/neon-animation/neon-animations.html">
<link rel="import" href="../../bower_components/iron-selector/iron-selector.html">


<link rel="import" href="labs002-avatar-snitpages.html">
<link rel="import" href="labs002-avatar-glassespages.html">
<link rel="import" href="labs002-avatar-beardpages.html">
<link rel="import" href="labs002-avatar-facepages.html">

<link rel="import" href="labs002-avatar-headpages.html">
<link rel="import" href="labs002-avatar-toppages.html">
<link rel="import" href="labs002-avatar-bottompages.html">
<link rel="import" href="labs002-avatar-shoespages.html">
<link rel="import" href="labs002-avatar-bodypages.html">

<link rel="import" href="labs002-skeletonpages.html">
<link rel="import" href="labs002-skeletonheadbandpages.html">


<link rel="import" href="labs002-colorpicker.html">

<link rel="import" href="../lo-configbtns/lo-configbtns.html">

<dom-module id="labs002-avatar">


  <style>
   :host {
      display: block;
      height: 100%;
      width: 100%;

    }

    neon-animated-pages {
      height: 100%;
    }

    .canvas {
      height: 100%;
      width: 100%;
    }

    .whitebg {
      background-color: white;

    }




    .thumbcontainer {
      width: 100%;
      max-width: 400px;
      height: 100%;
/*      max-height: 400px;*/
      position: relative;
      background: linear-gradient(to bottom, #a4e5f9 50%, white 50% ); 
/*       background-color: red;*/
    }

    .absolutepos {
      position: absolute;
      width: 100%;
      height: 100%;
/*      background-color: rgba(0,0,0,0.025);*/
    }


    .objectvaluesbar {
      width: 100%;
      margin: 0px;
      padding: 15px 15px 15px 20px;
      box-sizing:border-box;

      background-color: #fafafa;
      height: 60px;
      @apply(--layout-horizontal);
      @apply(--layout-center-center);
      box-sizing:border-box;

      border-radius: 0px 0px 2px 2px;
    }




    .valids {
      @apply(--layout-horizontal);
      @apply(--layout-end-justified);

      @apply(--layout-center);
      width: 20%;
      min-width: 40px;
      height: 100%;
    }

    .valids img {
      height: 15px;
      width: 15px;
    }

    .valids p {
      padding: 0px;

      margin: 0px 5px 0px 0px;

      font-size: var(--p-valids);
      font-family: OpensansBold;
      color: #333333;
    }



    .objectfirstvalue {
      width: 100%;
      @apply(--layout-horizontal);
      @apply(--layout-center);
      width: 80%;

    overflow: hidden;
    white-space: nowrap;
    text-overflow:ellipsis;

    }

    .objectfirstvalue p {
      width: 100%;
      text-align: left;

      margin: 0px;
      padding: 0px;
      font-family: Opensans;
      font-size: var(--p-size);
      color: #666666;

    overflow: hidden;
    white-space: nowrap;
    text-overflow:ellipsis;

    }







    .whitecanvas {
      background-color: white;
            width: 100%;
            height: 100%;
    }




  </style>
  <template>


<neon-animated-pages id="avatarmainpages" selected="{{selected}}" entry-animation="{{entryAnimation}}" exit-animation="{{exitAnimation}}">



<!--   THUMB PERVIEW -->
  <neon-animatable>
  <div class="canvas layout vertical center-center">

    <div class="thumbcontainer">

      <div class="absolutepos">
        <labs002-avatar-bodypages 
          id="lijf">
        </labs002-avatar-bodypages>
      </div>

      <div class="absolutepos">
        <labs002-avatar-shoespages 
          id="shoes"
          nrofitems="{{nrofshoes}}">
        </labs002-avatar-shoespages>
      </div>

      <div class="absolutepos">
        <labs002-avatar-bottompages 
          id="bottom"
          nrofitems="{{nrofbottom}}">
        </labs002-avatar-bottompages>
      </div>

      <div class="absolutepos">
        <labs002-avatar-toppages 
          id="top"
          nrofitems="{{nroftop}}">
        </labs002-avatar-toppages>
      </div>

      <div class="absolutepos">
        <labs002-avatar-headpages 
          id="head"
          nrofitems="{{nrofhead}}">
        </labs002-avatar-headpages>
      </div>

      <div class="absolutepos">
        <labs002-avatar-facepages 
          id="face">
        </labs002-avatar-facepages>
      </div>

      <div class="absolutepos">
        <labs002-avatar-glassespages 
          id="glasses"
          nrofitems="{{nrofglasses}}">
        </labs002-avatar-glassespages>
      </div>

      <div class="absolutepos">
        <labs002-avatar-beardpages 
          id="beard"
          nrofitems="{{nrofbeard}}">
        </labs002-avatar-beardpages>
      </div>

      <div class="absolutepos">
        <labs002-avatar-snitpages
        id="snit"
        nrofitems="{{nrofglasses}}">
        </labs002-avatar-snitpages>
      </div>

    </div>

<!--     <template is="dom-if" if="{{edit}}">
      <div class="righttbtns">

        <lo-configbtns context="snit" on-btn-tapped="next" next></lo-configbtns>
        <lo-configbtns context="glasses" on-btn-tapped="next" next></lo-configbtns>
        <lo-configbtns context="beard" on-btn-tapped="next" next></lo-configbtns>
        <lo-configbtns context="top" on-btn-tapped="next" next></lo-configbtns>
        <lo-configbtns context="bottom" on-btn-tapped="next" next></lo-configbtns>
        <lo-configbtns context="shoes" on-btn-tapped="next" next></lo-configbtns>

      </div>                
    </template>
 -->

  <div class="objectvaluesbar">
    <div class="objectfirstvalue">
      <small>{{firstvalue}}</small>
    </div>
    <div class="valids">
      <p>{{objectpeers.length}}</p>
      <img src="../../images/accept-small.svg">
    </div>
  </div>
  </div>
  </neon-animatable>



<!--   VALUES READ -->
 <neon-animatable>
 <h1>VALUES READ modus</h1>
 <button on-tap="toEdit">Naar de edit</button>
 </neon-animatable>



<!--   VALUES EDIT -->

  <neon-animatable>
    <div class="canvas whitebg">

<paper-input-container>
          <label>Voornaam</label>
          <input autofocus type="text" is="iron-input" bind-value="{{objectdata.firstname}}">
        </paper-input-container>
        <paper-input-container>
          <label>Naam</label>
          <input type="text" is="iron-input" bind-value="{{objectdata.lastname}}">
        </paper-input-container>
        <paper-input-container>
          <label>Geboortedatum</label>
          <input type="text" is="iron-input" bind-value="{{objectdata.birthdate}}" >
        </paper-input-container>
        <paper-input-container>
          <label>Geboorteplaats</label>
          <input type="text" is="iron-input" bind-value="{{objectdata.birthplace}}" >
        </paper-input-container>

      <button on-tap="save">SAVE VALUES</button>
    </div>
  </neon-animatable>




<!--   AVATAR CONFIG -->
 <neon-animatable>
 </neon-animatable>













  </neon-animated-pages>

  </template>
  <script>
  (function() {
    Polymer({
      is: 'labs002-avatar',

      behaviors: [
      Polymer.NeonAnimatableBehavior
      ],

      properties: {
      // objectconfig: {
      //     type: Object,
      //     observer: "_configChanged",
      //     notify: true
      // },

      // objectdata: {
      //     type: Object,
      //     observer: "_dataChanged",
      //     notify: true
      // },


      // edit: {
      //   type: Boolean,
      //   value: false
      // },


      // itemtocolor: {
      //   type: String,
      //   value: ''
      // },

      // opened: {
      //   type: Boolean,
      //   value: false,
      //   observer: "editListener"
      // },

      // active: {
      //   type: Boolean,
      //   value: false
      // },

      // selecteditem: {
      //   type: String,
      //   observer: "_selecteditem",
      //   value: ""
      // },

      // selectedcolor: {
      //   type: String,
      //   observer: "_selectedcolor"
      // }


        objectconfig: {
          type: Object,
          notify: true,
          observer: "_configChanged"
        },

        objectdata: {
          type: Object,
          notify: true,
          observer: "_dataChanged"
        },

        edit: {
          type: Boolean,
          value: false,
          observer: "_editChanged"

        },

        opened: {
          type: Boolean,
          value: false
        },

        objecthash: {
          type: String
        },


        modus: {     
          type: Number,
          value: 0,
          notify: true,
          observer: "_modusChanged"        
        }



      },

        // MODI //
        // 0: THUMB PERVIEW
        // 1: VALUES READ
        // 2: VALUES WRITE
        // 3: AVATAR CONFIG  



      ready: function(){
        this.$.avatarmainpages.selected = this.modus;
        this.itemtocolor = "lijf";
      },


      attached: function() {
        this.async(function() {
        this._configChanged();
        this._dataChanged();
      });

      this.entryAnimation = 'fade-in-animation';
      this.exitAnimation = 'fade-out-animation';
      },

      detached: function() {
        this.async(function() {
          //console.log(this.localName + '#' + this.id + ' was detached');
       });
      },




    previous: function(e){
        this.selecteditem = e.target.context;
        var item = document.getElementById(this.selecteditem);
        console.log("PREV: nr of items: ",item.nrofitems, " current item: ",this.objectconfig[this.selecteditem][0]);
         if(this.objectconfig[this.selecteditem][0]>=1){
          console.log(this.objectconfig[this.selecteditem][0]);
          this.objectconfig[this.selecteditem][0]--;
          e.target.active = true;
        } else {
          e.target.active = false;
        };
        this._configChanged();
        item.entryAnimation = "slide-to-left-animation";
        item.exitAnimation = "slide-right-animation";
      },

      next: function(e){
        this.selecteditem = e.target.context;
        var item = document.getElementById(this.selecteditem);
        console.log("NEXT: nr of items: ",item.nrofitems, " current item: ",this.objectconfig[this.selecteditem][0]);
        if(this.objectconfig[this.selecteditem][0]<=item.nrofitems-1){
          console.log(this.objectconfig[this.selecteditem][0]);
          this.objectconfig[this.selecteditem][0]++;
          e.target.active = true;
        } else {
          e.target.active = false;
        };
        this._configChanged();
        item.entryAnimation = "slide-to-right-animation";
        item.exitAnimation = "slide-left-animation";
      },



      _configChanged: function(){
        console.log('avatar conf changed: ', JSON.stringify(this.objectconfig));

        this.$.snit.selected = this.objectconfig.snit[0];
        this.$.snit.color = this.objectconfig.snit[1];

        this.$.glasses.selected = this.objectconfig.glasses[0];
        this.$.glasses.color = this.objectconfig.glasses[1];

        this.$.beard.selected = this.objectconfig.beard[0];
        this.$.beard.color = this.objectconfig.beard[1];

        this.$.face.selected = this.objectconfig.face[0];
        this.$.face.color = this.objectconfig.face[1];

         this.$.head.selected = this.objectconfig.head[0];
        this.$.head.color = this.objectconfig.lijf[1];

        this.$.top.selected = this.objectconfig.top[0];
        this.$.top.color = this.objectconfig.top[1];

        this.$.bottom.selected = this.objectconfig.bottom[0];
        this.$.bottom.color = this.objectconfig.bottom[1];

        this.$.shoes.selected = this.objectconfig.shoes[0];
        this.$.shoes.color = this.objectconfig.shoes[1];

        this.$.lijf.selected = this.objectconfig.lijf[0];
        this.$.lijf.color = this.objectconfig.lijf[1];

        // this.$.head.color = this.objectconfig.lijf[1];

      },

      _dataChanged: function(){

        this.firstname = this.objectdata.firstname;
        this.lastname = this.objectdata.lastname;
        this.birthdate = this.objectdata.birthdate;
        this.birthplace = this.objectdata.birthplace;
        //this.locked = this..locked;
      },

      unlock: function(){
        this.locked = false;
      },

      _editChanged: function(){
        console.log('Jamaar wa IS die edit nu eigenlijk?', this.edit);
      },


      _selectedcolor: function(){
        if(this.objectconfig){
          var item = this.selecteditem;
          var color = this.selectedcolor;
          this.objectconfig[item][1] = color;
          var avataritem = document.getElementById(item);
          avataritem.color = color;
          this._configChanged();
        };
      },


      editListener: function(){
          if(this.opened){
          this.selected = 1;
          } else {
            this.selected = 0;
          }; 
      },

      _modusChanged: function(){
        console.log('Modus in AVATAR:', this.modus);
        switch(this.modus){

          case 0:
            console.log('de modus is thumb!!!!');
            this.$.avatarmainpages.selected = this.modus;
          break;

          case 1:
            console.log('de modus is values read!!!!');
            this.$.avatarmainpages.selected = this.modus;
          break;

          case 2:
            console.log('de modus is values write!!!!');
            this.$.avatarmainpages.selected = this.modus;
          break;

          case 3:
            console.log('de modus is avatar config!!!!');
            this.$.avatarmainpages.selected = this.modus;
          break;

        };
      },


      toEdit:function(){
        this.modus = 2;
      },

      save:function(){
                this.fire('save-it', { datasetkey: this.objectname, dataset: this.objectdata, hash: this.objecthash, config: this.objectconfig });
                this.modus = 1;
              }





    });
  })();
  </script>
</dom-module>










